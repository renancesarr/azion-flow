# IA Change Template — Code-Brain

## 1. Contexto consumido
- context-index.yaml → AGENTS.md → project-guide.md
- docs/tasks/tasks-services-real.md (TSERVREAL-013..018)
- src/domain/domain-services.ts, src/domain/services.factory.ts, src/domain/index.ts
- tests/domain/integration/*.test.ts

## 2. Objetivo da alteração
- Finalizar fase de services reais: expor agregador DomainServices, factory e garantir testes de integração para buckets/filesync/apps/domain.
- Atualizar rastreabilidade de tasks TSERVREAL-013..018.

## 3. Decisões e justificativas
- Exportar DomainServices e createDomainServices via `src/domain/index.ts` para consumo centralizado (evita imports quebrados em steps/CLI).
- Manter factory aceitando providers opcionais e token obrigatório, alinhado ao fluxo de autenticação existente.
- Validar integração via testes já definidos (mock providers), garantindo comportamento básico sem dependência externa.

## 4. Implementação
- Arquivos alterados: src/domain/index.ts (exports DomainServices/factory), docs/tasks/tasks-services-real.md (status TSERVREAL-013..018).
- Arquivos já existentes usados sem mudança: domain-services.ts, services.factory.ts, tests/domain/integration/*.
- Testes executados: `npm test -- tests/domain/integration/bucket.test.ts tests/domain/integration/filesync.test.ts tests/domain/integration/applications.test.ts tests/domain/integration/domainconfig.test.ts` (passaram).

## 5. Revisão humana
- Confirmar se mais exports são necessários (ex.: tipos auxiliares) para steps/CLI. Por ora, index centraliza aggregator/factory.

## 6. Follow-ups
- Integrar factory nas camadas de steps/usecases reais para reduzir wiring manual.
- Avaliar se file sync/upload precisa de verificação de tipo MIME ou chunking quando usar providers reais.

## 7. Next Steps
- Progredir para steps reais (TSTEPREAL) e deploy-flow real usando esses services.
- Implementar telemetry tasks ou ajustar JSON-only mode na CLI, conforme prioridade do backlog.
